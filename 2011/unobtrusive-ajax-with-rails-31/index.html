<!DOCTYPE html>
<html>
<head>
<title>Samnang Chhun: Unobtrusive AJAX with Rails 3.1</title>
<meta content='AJAX with Rails, if you have some experiences with RJS in previous versions of Rails, then you will not see many differences when you implement AJAX in Rails 3.1.' name='description'>
<meta content='Rails, AJAX' name='keywords'>
<meta content='Samnang Chhun' name='author'>
<meta charset='utf-8'>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<meta content='IE=edge' http-equiv='X-UA-Compatible'>
<meta content='True' name='HandheldFriendly'>
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
<link href="/images/favicon.ico" rel="icon" type="image/ico" />
<link href="/stylesheets/application.css" rel="stylesheet" type="text/css" />
<link href='//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400' rel='stylesheet' type='text/css'>
<meta name='twitter:card' value='summary'>
<meta content='Samnang Chhun: Unobtrusive AJAX with Rails 3.1' property='og:title'>
<meta content='article' property='og:type'>
<meta content='http://samnang.me/2011/unobtrusive-ajax-with-rails-31/' property='og:url'>
<meta content='https://www.gravatar.com/avatar/863e24c91fcf1cd3c879ea62a401365e?size=200' property='og:image'>
<meta content='AJAX with Rails, if you have some experiences with RJS in previous versions of Rails, then you will not see many differences when you implement AJAX in Rails 3.1.' property='og:description'>

</head>
<body class='post-template nav-closed'>
<div class='nav'>
<h3 class='nav-title'>Menu</h3>
<a class='nav-close' href='#'>
<span class='hidden'>Close</span>
</a>
<ul>
<li class='nav-home' role='presentation'>
<a href='/'>Home</a>
</li>
<li class='nav-archives' role='presentation'>
<a href='/archives'>Archives</a>
</li>
<li class='nav-pair-with-me' role='presentation'>
<a href='/pair-with-me'>Pair with Me</a>
</li>
<li class='nav-about' role='presentation'>
<a href='/about'>About</a>
</li>
</ul>
<a class='subscribe-button icon-feed' href='/feed.xml'>Subscribe</a>
</div>
<span class='nav-cover'></span>

<div class='site-wrapper'>
<header class='main-header no-cover post-head'>
<nav class='main-nav clearfix'>
<a class='blog-logo' href='/'>
<img alt="Blog Logo" src="/images/profile-image.jpg" />
</a>
<a class='menu-button icon-menu' href='#'>
<span class='word'>Menu</span>
</a>
</nav>
</header>
<main class='content' role='main'>
<article class='post'>
<header class='post-header'>
<h1 class='post-title'>Unobtrusive AJAX with Rails 3.1</h1>
<section class='post-meta'>
<time class='post-date' datetime='2011-09-19'>
19 September 2011
</time>
on <a href='/tag/rails/'>Rails</a>, <a href='/tag/ajax/'>AJAX</a>
</section>
</header>
<section class='post-content'><p>Since Rails 3.0 release, Unobtrusive Javascript has introduced in building Rails application. It&rsquo;s a technique for separating the behavior of a web application from its content. It helps us to implement a web application that works for clients with and without enabled javascript. If users don&rsquo;t have enabled javascript, then it works just traditional web application.</p>

<p>AJAX with Rails, if you have some experiences with RJS in previous versions of Rails, then you will not see many differences when you implement AJAX in Rails 3.1. One different is you create template in javascript or coffee-script instead of RJS. Let&rsquo;s see how we implement application below:</p>

<p><img alt="Unobtrusive AJAX with Rails 3.1" src="https://img.skitch.com/20110918-rga8gjep56nrs24kq5c1d8esc8.png" /></p>

<p>Add js respond format to comments controller <code>app/controllers/comments_controller.rb</code>
<script src="https://gist.github.com/1225377.js?file=comments_controller.rb"></script>
<noscript>
    # app/controllers/comments<em>controller.rb<br>
    class CommentsController &lt; ApplicationController
      respond</em>to :html, :js</p>
<pre class="highlight plaintext"><code>  def index
    @comments = Comment.all
  end

  def create
    @comment = Comment.new(params[:comment])

    @comment.save

    respond_with @comment, :location =&gt; comments_url
  end
end
</code></pre>

<p></noscript> </p>

<p>Implement views <code>app/views/comments/index.html.erb</code> with remote form
<script src="https://gist.github.com/1225377.js?file=index.html.erb"></script>
<noscript>
    # app/views/comments/index.html.erb
    &lt;% title &ldquo;Comments for Ajax in Rails 3.1&rdquo; %&gt;</p>
<pre class="highlight plaintext"><code>&lt;div id="comments_count"&gt;&lt;%= comments_count %&gt;&lt;/div&gt;

&lt;div id="comments"&gt;
  &lt;%= render @comments %&gt;
&lt;/div&gt;

&lt;h3&gt;Add your comment:&lt;/h3&gt;

&lt;%= form_for Comment.new, :remote =&gt; true do |f| %&gt;
  &lt;%= f.error_messages %&gt;
  &lt;p&gt;
    &lt;%= f.label :name %&gt;&lt;br /&gt;
    &lt;%= f.text_field :name %&gt;
  &lt;/p&gt;
  &lt;p&gt;
    &lt;%= f.label :content, "Comment" %&gt;&lt;br /&gt;
    &lt;%= f.text_area :content, :rows =&gt; '12', :cols =&gt; 35 %&gt;
  &lt;/p&gt;
  &lt;p&gt;&lt;%= f.submit %&gt;&lt;/p&gt;
&lt;% end %&gt;
</code></pre>

<p></noscript>
<script src="https://gist.github.com/1225377.js?file=_comment.html.erb"></script>
<noscript>
    # app/views/comments/<em>comment.html.erb
    <div class="comment">
      <strong>&lt;%= comment.name %&gt;</strong>
      <em>on &lt;%= comment.created</em>at.strftime(&rsquo;%b %d, %Y at %I:%M %p&rsquo;) %&gt;</em>
      &lt;%= simple_format comment.content %&gt;
    </div>
</noscript></p>

<p>Add javascript or coffeescript template, I prefer (<code>app/views/comments/create.js.coffee</code>) to handle ajax request
<script src="https://gist.github.com/1225377.js?file=create.js.coffee"></script>
<noscript>
    # app/views/comments/create.js.coffee<br>
    $(&rsquo;&lt;%= escape_javascript(render(:partial =&gt; @comment))%&gt;&rsquo;)
      .appendTo(&rsquo;#comments&rsquo;)
      .hide()
      .fadeIn()</p>
<pre class="highlight plaintext"><code>$('#new_comment')[0].reset()

$('#comments_count').html '&lt;%= comments_count %&gt;'
</code></pre>

<p></noscript>
The complete source is on <a href="https://github.com/samnang/ajax_rails31_demo">Github</a>. So feel free to checkout and run it to see in action.</p>
</section>
<footer class='post-footer'>
<figure class='author-image'>
<a class='img' href='/about' style='background-image: url(https://www.gravatar.com/avatar/863e24c91fcf1cd3c879ea62a401365e?size=68)'>
<span class='hidden'>Samnang Chhun's Picture</span>
</a>
</figure>
<section class='author'>
<h4>
<a href='/about'>Samnang Chhun</a>
</h4>
<p></p>
Software Craftsman
<div class='author-meta'>
<span class='author-location icon-location'>Phnom Penh, Cambodia</span>
</div>
</section>
<section class='share'>
<h4>Share this post</h4>
<a class='icon-twitter' href='https://twitter.com/share?text=Unobtrusive AJAX with Rails 3.1&amp;amp;url=http://samnang.me/2011/unobtrusive-ajax-with-rails-31/' onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
<span class='hidden'>Twitter</span>
</a>
<a class='icon-facebook' href='https://www.facebook.com/sharer/sharer.php?u=http://samnang.me/2011/unobtrusive-ajax-with-rails-31/' onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
<span class='hidden'>Facebook</span>
</a>
<a class='icon-google-plus' href='https://plus.google.com/share?url=http://samnang.me/2011/unobtrusive-ajax-with-rails-31/' onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
<span class='hidden'>Google+</span>
</a>
</section>
</footer>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'samnang';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</article>
</main>

<footer class='site-footer clearfix'>
<section class='copyright'>
<a href='/'>Samnang Chhun</a>
&copy;
2015
</section>
<section class='poweredby'>
Casper theme powered by
<a href='https://ghost.org'>Ghost</a>
</section>
</footer>
</div>
<script src="/javascripts/application.js" type="text/javascript"></script>
</body>
</html>
